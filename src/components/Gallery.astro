---
// Gallery component con filtros por categorías y paginación
interface Props {
  title?: string;
}
---

<section class="py-20 bg-gray-50">
  <div class="container mx-auto px-4">
    <div class="text-center mb-12">
      <h2 class="text-3xl md:text-4xl font-bold font-playfair mb-4" style="color: #5771FE;">
        Galería Institucional
      </h2>
      <div class="w-24 h-1 mx-auto mb-6" style="background-color: rgb(52, 183, 13);"></div>
      <p class="text-gray-600 max-w-2xl mx-auto mb-8">
        Explora los momentos más destacados de nuestra comunidad educativa
      </p>
    </div>

    <!-- Filtros de categorías -->
    <div class="flex flex-wrap justify-center gap-2 md:gap-4 mb-12 px-4">
      <button 
        class="filter-btn active px-3 py-2 md:px-6 md:py-3 rounded-full font-medium transition-all duration-300 hover:scale-105 text-sm md:text-base"
        data-filter="all"
        style="background-color: rgb(52, 183, 13); color: white;"
      >
        Todas
      </button>
      <button 
        class="filter-btn px-3 py-2 md:px-6 md:py-3 rounded-full font-medium transition-all duration-300 hover:scale-105 bg-white text-gray-700 border-2 border-gray-200 text-sm md:text-base"
        data-filter="academicas"
        style="hover: border-color: #5771FE;"
      >
        <span class="hidden sm:inline">Actividades </span>Académicas
      </button>
      <button 
        class="filter-btn px-3 py-2 md:px-6 md:py-3 rounded-full font-medium transition-all duration-300 hover:scale-105 bg-white text-gray-700 border-2 border-gray-200 text-sm md:text-base"
        data-filter="deportivas"
        style="hover: border-color: rgb(52, 183, 13);"
      >
        Deportivas
      </button>
      <button 
        class="filter-btn px-3 py-2 md:px-6 md:py-3 rounded-full font-medium transition-all duration-300 hover:scale-105 bg-white text-gray-700 border-2 border-gray-200 text-sm md:text-base"
        data-filter="culturales"
        style="hover: border-color: #5771FE;"
      >
        Culturales
      </button>
      <button 
        class="filter-btn px-3 py-2 md:px-6 md:py-3 rounded-full font-medium transition-all duration-300 hover:scale-105 bg-white text-gray-700 border-2 border-gray-200 text-sm md:text-base"
        data-filter="militares"
        style="hover: border-color: #dc3545;"
      >
        <span class="hidden sm:inline">Formación </span>Militar
      </button>
      <button 
        class="filter-btn px-3 py-2 md:px-6 md:py-3 rounded-full font-medium transition-all duration-300 hover:scale-105 bg-white text-gray-700 border-2 border-gray-200 text-sm md:text-base"
        data-filter="eventos"
        style="hover: border-color: rgb(52, 183, 13);"
      >
        <span class="hidden sm:inline">Eventos </span>Especiales
      </button>
    </div>

    <!-- Grid de la galería -->
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8" id="gallery-grid">
      
      <!-- Actividades Académicas -->
      <div class="gallery-item academicas" data-category="academicas">
        <div class="bg-white rounded-xl overflow-hidden shadow-lg group h-[360px] flex flex-col">
          <div class="relative h-[240px] overflow-hidden">
            <img 
              src={`${import.meta.env.BASE_URL}/Carrusel dia del niño/1.webp`} 
              alt="Actividades académicas"
              class="w-full h-full object-cover transition-transform duration-300 group-hover:scale-110"
            />
            <div class="absolute inset-0 bg-black/20 group-hover:bg-black/10 transition-all duration-300"></div>
            <div class="absolute top-3 left-3 text-white px-2 py-1 rounded text-xs font-medium" style="background-color: #5771FE;">
              Académico
            </div>
          </div>
          <div class="p-4 flex-1 flex flex-col justify-between">
            <h3 class="font-semibold text-gray-800 mb-2">Actividades Educativas</h3>
            <p class="text-sm text-gray-600">Desarrollo de competencias académicas</p>
          </div>
        </div>
      </div>

      <div class="gallery-item academicas" data-category="academicas">
        <div class="bg-white rounded-xl overflow-hidden shadow-lg group h-[360px] flex flex-col">
          <div class="relative h-[240px] overflow-hidden">
            <img 
              src={`${import.meta.env.BASE_URL}/Carrusel dia del niño/2.webp`} 
              alt="Clase interactiva"
              class="w-full h-full object-cover transition-transform duration-300 group-hover:scale-110"
            />
            <div class="absolute inset-0 bg-black/20 group-hover:bg-black/10 transition-all duration-300"></div>
            <div class="absolute top-3 left-3 text-white px-2 py-1 rounded text-xs font-medium" style="background-color: #5771FE;">
              Académico
            </div>
          </div>
          <div class="p-4 flex-1 flex flex-col justify-between">
            <h3 class="font-semibold text-gray-800 mb-2">Aprendizaje Interactivo</h3>
            <p class="text-sm text-gray-600">Metodologías educativas innovadoras</p>
          </div>
        </div>
      </div>

      <!-- Actividades Deportivas -->
      <div class="gallery-item deportivas" data-category="deportivas">
        <div class="bg-white rounded-xl overflow-hidden shadow-lg group h-[360px] flex flex-col">
          <div class="relative h-[240px] overflow-hidden">
            <img 
              src={`${import.meta.env.BASE_URL}/Carrusel dia del niño/3.webp`} 
              alt="Actividades deportivas"
              class="w-full h-full object-cover transition-transform duration-300 group-hover:scale-110"
            />
            <div class="absolute inset-0 bg-black/20 group-hover:bg-black/10 transition-all duration-300"></div>
            <div class="absolute top-3 left-3 text-white px-2 py-1 rounded text-xs font-medium" style="background-color: rgb(52, 183, 13);">
              Deportivo
            </div>
          </div>
          <div class="p-4 flex-1 flex flex-col justify-between">
            <h3 class="font-semibold text-gray-800 mb-2">Actividades Físicas</h3>
            <p class="text-sm text-gray-600">Desarrollo deportivo integral</p>
          </div>
        </div>
      </div>

      <div class="gallery-item deportivas" data-category="deportivas">
        <div class="bg-white rounded-xl overflow-hidden shadow-lg group h-[360px] flex flex-col">
          <div class="relative h-[240px] overflow-hidden">
            <img 
              src={`${import.meta.env.BASE_URL}/Carrusel dia del niño/4.jpg`} 
              alt="Juegos deportivos"
              class="w-full h-full object-cover transition-transform duration-300 group-hover:scale-110"
            />
            <div class="absolute inset-0 bg-black/20 group-hover:bg-black/10 transition-all duration-300"></div>
            <div class="absolute top-3 left-3 text-white px-2 py-1 rounded text-xs font-medium" style="background-color: rgb(52, 183, 13);">
              Deportivo
            </div>
          </div>
          <div class="p-4 flex-1 flex flex-col justify-between">
            <h3 class="font-semibold text-gray-800 mb-2">Juegos y Competencias</h3>
            <p class="text-sm text-gray-600">Fomento del espíritu deportivo</p>
          </div>
        </div>
      </div>

      <!-- Actividades Culturales -->
      <div class="gallery-item culturales" data-category="culturales">
        <div class="bg-white rounded-xl overflow-hidden shadow-lg group h-[360px] flex flex-col">
          <div class="relative h-[240px] overflow-hidden">
            <img 
              src={`${import.meta.env.BASE_URL}/Carrusel dia del niño/5.webp`} 
              alt="Actividades culturales"
              class="w-full h-full object-cover transition-transform duration-300 group-hover:scale-110"
            />
            <div class="absolute inset-0 bg-black/20 group-hover:bg-black/10 transition-all duration-300"></div>
            <div class="absolute top-3 left-3 text-white px-2 py-1 rounded text-xs font-medium" style="background-color: #5771FE;">
              Cultural
            </div>
          </div>
          <div class="p-4 flex-1 flex flex-col justify-between">
            <h3 class="font-semibold text-gray-800 mb-2">Expresión Artística</h3>
            <p class="text-sm text-gray-600">Desarrollo de talentos culturales</p>
          </div>
        </div>
      </div>

      <div class="gallery-item culturales" data-category="culturales">
        <div class="bg-white rounded-xl overflow-hidden shadow-lg group h-[360px] flex flex-col">
          <div class="relative h-[240px] overflow-hidden">
            <img 
              src={`${import.meta.env.BASE_URL}/Carrusel dia del niño/6.webp`} 
              alt="Eventos culturales"
              class="w-full h-full object-cover transition-transform duration-300 group-hover:scale-110"
            />
            <div class="absolute inset-0 bg-black/20 group-hover:bg-black/10 transition-all duration-300"></div>
            <div class="absolute top-3 left-3 text-white px-2 py-1 rounded text-xs font-medium" style="background-color: #5771FE;">
              Cultural
            </div>
          </div>
          <div class="p-4 flex-1 flex flex-col justify-between">
            <h3 class="font-semibold text-gray-800 mb-2">Actividades Recreativas</h3>
            <p class="text-sm text-gray-600">Integración y desarrollo cultural</p>
          </div>
        </div>
      </div>

      <!-- Formación Militar -->
      <div class="gallery-item militares" data-category="militares">
        <div class="bg-white rounded-xl overflow-hidden shadow-lg group h-[360px] flex flex-col">
          <div class="relative h-[240px] overflow-hidden">
            <img 
              src={`${import.meta.env.BASE_URL}/Carrusel ejercicios de campo/1.webp`} 
              alt="Ejercicios militares"
              class="w-full h-full object-cover transition-transform duration-300 group-hover:scale-110"
            />
            <div class="absolute inset-0 bg-black/20 group-hover:bg-black/10 transition-all duration-300"></div>
            <div class="absolute top-3 left-3 text-white px-2 py-1 rounded text-xs font-medium" style="background-color: #dc3545;">
              Militar
            </div>
          </div>
          <div class="p-4 flex-1 flex flex-col justify-between">
            <h3 class="font-semibold text-gray-800 mb-2">Ejercicios de Campo</h3>
            <p class="text-sm text-gray-600">Entrenamiento y formación militar</p>
          </div>
        </div>
      </div>

      <div class="gallery-item militares" data-category="militares">
        <div class="bg-white rounded-xl overflow-hidden shadow-lg group h-[360px] flex flex-col">
          <div class="relative h-[240px] overflow-hidden">
            <img 
              src={`${import.meta.env.BASE_URL}/Carrusel ejercicios de campo/2.webp`} 
              alt="Formación militar"
              class="w-full h-full object-cover transition-transform duration-300 group-hover:scale-110"
            />
            <div class="absolute inset-0 bg-black/20 group-hover:bg-black/10 transition-all duration-300"></div>
            <div class="absolute top-3 left-3 text-white px-2 py-1 rounded text-xs font-medium" style="background-color: #dc3545;">
              Militar
            </div>
          </div>
          <div class="p-4 flex-1 flex flex-col justify-between">
            <h3 class="font-semibold text-gray-800 mb-2">Instrucción Militar</h3>
            <p class="text-sm text-gray-600">Desarrollo de habilidades tácticas</p>
          </div>
        </div>
      </div>

      <!-- Eventos Especiales -->
      <div class="gallery-item eventos" data-category="eventos">
        <div class="bg-white rounded-xl overflow-hidden shadow-lg group h-[360px] flex flex-col">
          <div class="relative h-[240px] overflow-hidden">
            <img 
              src={`${import.meta.env.BASE_URL}/carrusel aniversario 59/1.webp`} 
              alt="Aniversario 59"
              class="w-full h-full object-cover transition-transform duration-300 group-hover:scale-110"
            />
            <div class="absolute inset-0 bg-black/20 group-hover:bg-black/10 transition-all duration-300"></div>
            <div class="absolute top-3 left-3 text-white px-2 py-1 rounded text-xs font-medium" style="background-color: rgb(52, 183, 13);">
              Evento
            </div>
          </div>
          <div class="p-4 flex-1 flex flex-col justify-between">
            <h3 class="font-semibold text-gray-800 mb-2">59 Años de Historia</h3>
            <p class="text-sm text-gray-600">Celebración del aniversario institucional</p>
          </div>
        </div>
      </div>

      <div class="gallery-item eventos" data-category="eventos">
        <div class="bg-white rounded-xl overflow-hidden shadow-lg group h-[360px] flex flex-col">
          <div class="relative h-[240px] overflow-hidden">
            <img 
              src={`${import.meta.env.BASE_URL}/carrusel aniversario 59/2.webp`} 
              alt="Celebración aniversario"
              class="w-full h-full object-cover transition-transform duration-300 group-hover:scale-110"
            />
            <div class="absolute inset-0 bg-black/20 group-hover:bg-black/10 transition-all duration-300"></div>
            <div class="absolute top-3 left-3 text-white px-2 py-1 rounded text-xs font-medium" style="background-color: rgb(52, 183, 13);">
              Evento
            </div>
          </div>
          <div class="p-4 flex-1 flex flex-col justify-between">
            <h3 class="font-semibold text-gray-800 mb-2">Celebración Institucional</h3>
            <p class="text-sm text-gray-600">Momentos memorables del aniversario</p>
          </div>
        </div>
      </div>

      <!-- Página 2 -->
      <div class="gallery-item militares hidden" data-category="militares" data-page="2">
        <div class="bg-white rounded-xl overflow-hidden shadow-lg group h-[360px] flex flex-col">
          <div class="relative h-[240px] overflow-hidden">
            <img 
              src={`${import.meta.env.BASE_URL}/Carrusel ejercicios de campo/3.webp`} 
              alt="Entrenamiento militar"
              class="w-full h-full object-cover transition-transform duration-300 group-hover:scale-110"
            />
            <div class="absolute inset-0 bg-black/20 group-hover:bg-black/10 transition-all duration-300"></div>
            <div class="absolute top-3 left-3 text-white px-2 py-1 rounded text-xs font-medium" style="background-color: #dc3545;">
              Militar
            </div>
          </div>
          <div class="p-4 flex-1 flex flex-col justify-between">
            <h3 class="font-semibold text-gray-800 mb-2">Entrenamiento Táctico</h3>
            <p class="text-sm text-gray-600">Ejercicios de campo avanzados</p>
          </div>
        </div>
      </div>

      <div class="gallery-item eventos hidden" data-category="eventos" data-page="2">
        <div class="bg-white rounded-xl overflow-hidden shadow-lg group h-[360px] flex flex-col">
          <div class="relative h-[240px] overflow-hidden">
            <img 
              src={`${import.meta.env.BASE_URL}/carrusel aniversario 59/3.webp`} 
              alt="Celebración aniversario"
              class="w-full h-full object-cover transition-transform duration-300 group-hover:scale-110"
            />
            <div class="absolute inset-0 bg-black/20 group-hover:bg-black/10 transition-all duration-300"></div>
            <div class="absolute top-3 left-3 text-white px-2 py-1 rounded text-xs font-medium" style="background-color: rgb(52, 183, 13);">
              Evento
            </div>
          </div>
          <div class="p-4 flex-1 flex flex-col justify-between">
            <h3 class="font-semibold text-gray-800 mb-2">Momentos Especiales</h3>
            <p class="text-sm text-gray-600">Celebración del aniversario</p>
          </div>
        </div>
      </div>

    </div>

    <!-- Paginación -->
    <div class="flex justify-center items-center space-x-4 mb-8">
      <button 
        id="prev-page" 
        class="px-4 py-2 rounded-lg font-medium transition-all duration-300 bg-white border-2 border-gray-200 text-gray-700 hover:shadow-lg disabled:opacity-50 disabled:cursor-not-allowed"
        style="hover: border-color: rgb(52, 183, 13);"
        disabled
      >
        <svg class="w-5 h-5 inline mr-2" fill="currentColor" viewBox="0 0 20 20">
          <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd"></path>
        </svg>
        Anterior
      </button>
      
      <div class="flex items-center space-x-2">
        <button class="page-btn w-10 h-10 rounded-full font-medium transition-all duration-300 text-white" 
                style="background-color: rgb(52, 183, 13);" 
                data-page="1">1</button>
        <button class="page-btn w-10 h-10 rounded-full font-medium transition-all duration-300 bg-white border-2 border-gray-200 text-gray-700 hover:shadow-lg" 
                style="hover: border-color: rgb(52, 183, 13);" 
                data-page="2">2</button>
      </div>
      
      <button 
        id="next-page" 
        class="px-4 py-2 rounded-lg font-medium transition-all duration-300 bg-white border-2 border-gray-200 text-gray-700 hover:shadow-lg"
        style="hover: border-color: rgb(52, 183, 13);"
      >
        Siguiente
        <svg class="w-5 h-5 inline ml-2" fill="currentColor" viewBox="0 0 20 20">
          <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"></path>
        </svg>
      </button>
    </div>

    <!-- Mensaje cuando no hay resultados -->
    <div id="no-results" class="hidden text-center py-12">
      <div class="w-24 h-24 mx-auto mb-4 bg-gray-100 rounded-full flex items-center justify-center">
        <svg class="w-12 h-12 text-gray-400" fill="currentColor" viewBox="0 0 20 20">
          <path fill-rule="evenodd" d="M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z" clip-rule="evenodd"></path>
        </svg>
      </div>
      <h3 class="text-xl font-semibold text-gray-600 mb-2">No se encontraron imágenes</h3>
      <p class="text-gray-500">Prueba con otra categoría</p>
    </div>
  </div>
</section>

<style>
  .gallery-item {
    animation: fadeIn 0.5s ease-in-out;
  }

  @keyframes fadeIn {
    from {
      opacity: 0;
      transform: translateY(20px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }
</style>

<script>
  const filterButtons = document.querySelectorAll('.filter-btn');
  const galleryItems = document.querySelectorAll('.gallery-item');
  const noResults = document.getElementById('no-results');
  const pageButtons = document.querySelectorAll('.page-btn');
  const prevPageBtn = document.getElementById('prev-page');
  const nextPageBtn = document.getElementById('next-page');
  
  let currentPage = 1;
  let currentFilter = 'all';
  const itemsPerPage = 8;
  
  const filterColors = {
    all: { bg: 'rgb(52, 183, 13)', text: 'white' },
    academicas: { bg: '#5771FE', text: 'white' },
    deportivas: { bg: 'rgb(52, 183, 13)', text: 'white' },
    culturales: { bg: '#5771FE', text: 'white' },
    militares: { bg: '#dc3545', text: 'white' },
    eventos: { bg: 'rgb(52, 183, 13)', text: 'white' }
  };
  
  function getFilteredItems() {
    if (currentFilter === 'all') {
      return Array.from(galleryItems);
    }
    return Array.from(galleryItems).filter(item => 
      item.getAttribute('data-category') === currentFilter
    );
  }
  
  function showPage(page) {
    const filteredItems = getFilteredItems();
    const totalPages = Math.ceil(filteredItems.length / itemsPerPage);
    
    // Ocultar todos los elementos primero
    galleryItems.forEach(item => {
      item.classList.add('hidden');
    });
    
    // Mostrar elementos de la página actual
    const startIndex = (page - 1) * itemsPerPage;
    const endIndex = startIndex + itemsPerPage;
    const itemsToShow = filteredItems.slice(startIndex, endIndex);
    
    itemsToShow.forEach(item => {
      item.classList.remove('hidden');
    });
    
    // Actualizar estado de botones de paginación
    if (prevPageBtn) prevPageBtn.disabled = page === 1;
    if (nextPageBtn) nextPageBtn.disabled = page === totalPages;
    
    // Actualizar botones de página
    pageButtons.forEach(btn => {
      const btnPage = parseInt(btn.getAttribute('data-page') || '1');
      if (btnPage === page) {
        btn.style.backgroundColor = 'rgb(52, 183, 13)';
        btn.style.color = 'white';
        btn.style.borderColor = 'rgb(52, 183, 13)';
      } else {
        btn.style.backgroundColor = 'white';
        btn.style.color = '#374151';
        btn.style.borderColor = '#e5e7eb';
      }
    });
    
    // Mostrar/ocultar mensaje de "no resultados"
    if (noResults) {
      if (itemsToShow.length === 0) {
        noResults.classList.remove('hidden');
      } else {
        noResults.classList.add('hidden');
      }
    }
    
    // Actualizar visibilidad de controles de paginación
    const paginationControls = document.querySelector('.flex.justify-center.items-center.space-x-4.mb-8');
    if (paginationControls) {
      if (totalPages <= 1) {
        paginationControls.classList.add('hidden');
      } else {
        paginationControls.classList.remove('hidden');
      }
    }
  }
  
  function filterGallery(category) {
    currentFilter = category;
    currentPage = 1;
    showPage(1);
  }
  
  function updateFilterButtons(activeFilter) {
    filterButtons.forEach(btn => {
      const filter = btn.getAttribute('data-filter');
      if (filter) {
        const colors = filterColors[filter];
        
        if (filter === activeFilter) {
          btn.classList.add('active');
          btn.style.backgroundColor = colors.bg;
          btn.style.color = colors.text;
          btn.style.borderColor = colors.bg;
        } else {
          btn.classList.remove('active');
          btn.style.backgroundColor = 'white';
          btn.style.color = '#374151';
          btn.style.borderColor = '#e5e7eb';
        }
      }
    });
  }
  
  // Event listeners
  filterButtons.forEach(btn => {
    btn.addEventListener('click', () => {
      const filter = btn.getAttribute('data-filter');
      if (filter) {
        filterGallery(filter);
        updateFilterButtons(filter);
      }
    });
    
    btn.addEventListener('mouseenter', () => {
      if (!btn.classList.contains('active')) {
        const filter = btn.getAttribute('data-filter');
        if (filter) {
          const colors = filterColors[filter];
          btn.style.borderColor = colors.bg;
        }
      }
    });
    
    btn.addEventListener('mouseleave', () => {
      if (!btn.classList.contains('active')) {
        btn.style.borderColor = '#e5e7eb';
      }
    });
  });
  
  pageButtons.forEach(btn => {
    btn.addEventListener('click', () => {
      const pageAttr = btn.getAttribute('data-page');
      if (pageAttr) {
        const page = parseInt(pageAttr);
        currentPage = page;
        showPage(page);
      }
    });
  });
  
  if (prevPageBtn) {
    prevPageBtn.addEventListener('click', () => {
      if (currentPage > 1) {
        currentPage--;
        showPage(currentPage);
      }
    });
  }
  
  if (nextPageBtn) {
    nextPageBtn.addEventListener('click', () => {
      const filteredItems = getFilteredItems();
      const totalPages = Math.ceil(filteredItems.length / itemsPerPage);
      if (currentPage < totalPages) {
        currentPage++;
        showPage(currentPage);
      }
    });
  }
  
  // Inicializar la galería
  document.addEventListener('DOMContentLoaded', () => {
    showPage(1);
  });
</script>
